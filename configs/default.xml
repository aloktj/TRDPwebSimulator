<?xml version="1.0" encoding="UTF-8"?>
<TrdpConfiguration>
  <datasets>
    <dataset name="HeartbeatDataset" id="100" size="4" description="Periodic heartbeat counter">
      <variable name="HeartbeatCounter" type="UINT32" offset="0" description="Monotonic heartbeat value" />
    </dataset>

    <dataset name="SystemStatus" id="101" size="16" description="Aggregated status payload for RX/TX validation">
      <variable name="StatusCode" type="UINT16" offset="0" description="Application status code" />
      <variable name="ErrorFlags" type="UINT16" offset="2" description="Bitmask of simulated error states" />
      <variable name="TemperatureC" type="FLOAT" offset="4" description="Board temperature in Celsius" />
      <variable name="UptimeMs" type="UINT32" offset="8" description="Monotonic uptime counter" />
      <variable name="Reserved" type="BYTES" size="4" offset="12" description="Reserved padding for alignment" />
    </dataset>

    <dataset name="ControlCommand" id="102" size="12" description="Outgoing control command payload">
      <variable name="CommandId" type="UINT16" offset="0" description="Logical command identifier" />
      <variable name="TargetSpeed" type="FLOAT" offset="4" description="Target speed in km/h" />
      <variable name="EnableLogging" type="BOOL" offset="8" description="Toggle verbose logging" />
      <variable name="ResetFlags" type="UINT8" offset="9" description="Bitmask of reset actions" />
      <variable name="Reserved" type="BYTES" size="2" offset="10" description="Alignment padding" />
    </dataset>

    <dataset name="MdRequest" id="103" size="20" description="Maintenance MD request frame">
      <variable name="RequestId" type="UINT32" offset="0" description="Unique request identifier" />
      <variable name="PayloadLength" type="UINT16" offset="4" description="Number of valid payload bytes" />
      <variable name="Payload" type="BYTES" size="12" offset="6" description="Opaque request payload" />
      <variable name="Checksum" type="UINT16" offset="18" description="CRC16 over header+payload" />
    </dataset>

    <dataset name="MdResponse" id="104" size="24" description="Maintenance MD response frame">
      <variable name="ResponseId" type="UINT32" offset="0" description="Echoed request identifier" />
      <variable name="ResultCode" type="UINT16" offset="4" description="Result of maintenance action" />
      <variable name="DataLength" type="UINT16" offset="6" description="Number of valid data bytes" />
      <variable name="Data" type="BYTES" size="14" offset="8" description="Opaque response data" />
      <variable name="TailMarker" type="UINT16" offset="22" description="Static marker for parsing validation" />
    </dataset>
  </datasets>

  <telegrams>
    <telegram name="TxHeartbeat" comId="1001" direction="TX" type="PD" dataset="HeartbeatDataset" cycle="1000" ttl="64" port="17224" srcIp="10.0.0.1" destIp="10.0.0.2" description="Simple TX heartbeat for connectivity checks" />
    <telegram name="RxHeartbeat" comId="1002" direction="RX" type="PD" dataset="HeartbeatDataset" cycle="1000" ttl="64" port="17224" srcIp="10.0.0.2" destIp="10.0.0.1" description="RX heartbeat used to confirm RX decoding" />

    <telegram name="TxStatus" comId="1101" direction="TX" type="PD" dataset="SystemStatus" cycle="500" ttl="64" port="17224" srcIp="10.0.0.1" destIp="10.0.0.2" description="TX system status payload" />
    <telegram name="RxStatus" comId="1102" direction="RX" type="PD" dataset="SystemStatus" cycle="500" ttl="64" port="17224" srcIp="10.0.0.2" destIp="10.0.0.1" description="RX system status payload" />

    <telegram name="TxControlCommand" comId="1201" direction="TX" type="PD" dataset="ControlCommand" cycle="200" ttl="64" port="17224" srcIp="10.0.0.1" destIp="10.0.0.2" description="Control command to exercise TX marshalling" />
    <telegram name="RxControlCommandAck" comId="1202" direction="RX" type="PD" dataset="ControlCommand" cycle="200" ttl="64" port="17224" srcIp="10.0.0.2" destIp="10.0.0.1" description="Echoed control data for RX validation" />

    <telegram name="MdMaintenanceRequest" comId="2001" direction="TX" type="MD" dataset="MdRequest" ttl="64" port="17224" srcIp="10.0.0.1" destIp="10.0.0.2" description="MD request covering message data path" />
    <telegram name="MdMaintenanceResponse" comId="2002" direction="RX" type="MD" dataset="MdResponse" ttl="64" port="17224" srcIp="10.0.0.2" destIp="10.0.0.1" description="MD response used to verify MD parsing" />
  </telegrams>
</TrdpConfiguration>
